[gcode_macro PID_TUNE_HOTEND]
description: Run PID tune and save to a Kalico profile
gcode:
    {% set temp = params.TEMP|default(230)|float %}
    {% set profile = params.PROFILE|default("hotend_default") %}

    M117 PID tune hotend
    PID_CALIBRATE HEATER=extruder TARGET={{ temp }}
    M117 Saving hotend PID
    SAVE_CONFIG PROFILE={{ profile }}


[gcode_macro PID_TUNE_BED]
description: Run PID tune on bed and save to Kalico profile
gcode:
    {% set temp = params.TEMP|default(60)|float %}
    {% set profile = params.PROFILE|default("bed_default") %}

    M117 PID tune bed to {{temp}}C
    PID_CALIBRATE HEATER=heater_bed TARGET={{temp}}

    M117 Saving bed PID to {{profile}}
    SAVE_CONFIG PROFILE={{profile}}

[gcode_macro LOAD_PID_PROFILE]
description: Load a saved PID profile
gcode:
    {% set profile = params.PROFILE|default("default") %}
    M117 Loading PID profile: {{profile}}
    LOAD_PROFILE PROFILE={{profile}}

[gcode_macro LIST_PID_PROFILES]
description: Print all stored Kalico profiles
gcode:
    M117 Stored Profiles
    LIST_PROFILES

[gcode_macro DELETE_PID_PROFILE]
description: Delete a Kalico profile
gcode:
    {% set profile = params.PROFILE %}
    {% if profile is not defined %}
        M117 ERROR: PROFILE=<name> required
    {% else %}
        M117 Deleting profile: {{profile}}
        DELETE_PROFILE PROFILE={{profile}}
    {% endif %}
